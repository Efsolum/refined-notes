* SSH Grimore
** Installation
*** recipe 1471207682, install with guix

$ guix pull
$ guix package -i openssh rsync sshpass sshfs-fuse

$ which ssh && ssh -V
** SSH Agent

*** Start ssh agent

$ eval "$(ssh-agent -s)"
*** Add a key
$ ssh-add <key-path>/<private-key>

*** Set the SSH Agent Socker Location
This allows for the sharing of an existing ssh-agent

$ export SSH_AGENT_PID=<pid>
$ export SSH_AUTH_SOCK=<path-to-socker>

Example:
export SSH_AUTH_SOCK=/tmp/ssh-et1CVxAiXx0n/agent.1453

** SSH/Key life cycle
-p port
Port to connect to on the remote host.  This can be specified on a
per-host basis in the configuration file.

*** Login to server/host

ssh-add -L
ssh-add <key-path>/<private-key> # add key if not in the agent
ssh <username>@<host> [-p <port>]
ssh-add -L

*** New ssh key

cd <key-path>
ssh-keygen -t ed25519 -f <name>_ed25519
cd ~/
ssh-add  <priviate-key-path>
ssh-add -L
# ensure there are no active connection are sockets
ssh-copy-id -i <public-key-path> [-p <port>] <username>@<remote-server>
ssh <username>@<remote-server>

*** Old ssh key

# on local server
cd <key-path>
mv -v <key> <key>_old
# see/goto new ssh key, then continue.

ssh <username>@<host> [-p <port>]
sed '/<name of file>$/d' ~/.ssh/authorized_keys
sed -i '/<name of file>$/d' ~/.ssh/authorized_keys
** SSH to a machine via another (gateway)


$ ssh -t <user1>@<gateway> ssh <user2>@<target>

Example
$ ssh -t jake@jax.local ssh user@192.168.122.181
** Disable Root Login

Step 1: Modify Configuration

$ $EDITOR /etc/ssh/sshd_config

Change the following line from
#PermitRootLogin no

to

PermitRootLogin no


Step 2: Restart SSH

restart SSH Daemon
/etc/init.d/sshd restart
or
service sshd restart

Step 3: Test Root Login

ssh root@<server>

